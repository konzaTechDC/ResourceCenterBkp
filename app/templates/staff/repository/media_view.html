{% extends 'staff/repository_layout.html' %}
{% load staticfiles %}
{% load model_tags %}
{% load form_tags %}
{% block content %}

    <!-- start: page -->
	<section class="content-with-menu content-with-menu-has-toolbar media-gallery">
		<div class="content-with-menu-container">
			<div class="inner-menu-toggle">
				<a href="#" class="inner-menu-expand" data-open="inner-menu">
					Show Bar <i class="fa fa-chevron-right"></i>
				</a>
			</div>
							
			<menu id="content-menu" class="inner-menu" role="menu">
				<div class="nano">
					<div class="nano-content">
							
						<div class="inner-menu-toggle-inside">
							<a href="#" class="inner-menu-collapse">
								<i class="fa fa-chevron-up visible-xs-inline"></i><i class="fa fa-chevron-left hidden-xs-inline"></i> Hide Bar
							</a>
							<a href="#" class="inner-menu-expand" data-open="inner-menu">
								Show Bar <i class="fa fa-chevron-down"></i>
							</a>
						</div>
							
						<div class="inner-menu-content">
							
							{% if request.user.is_authenticated %}
							<h3  class="text text-primary">
								{{ title }}
							</h3>
							{% endif %}
							
							<hr class="separator" />
							
							<div class="sidebar-widget m-none">
								<div class="widget-header clearfix">
									<h6 class="title pull-left mt-xs">Folders</h6>
									{% if request.user.is_authenticated %}
									<div class="pull-right">
										<a href="#modalForm" class="modal-with-form btn btn-dark btn-sm btn-widget-act">Add Folder</a>

									<!-- Modal Form -->
									<div id="modalForm" class="modal-block modal-block-primary mfp-hide">
										<section class="panel">
											<header class="panel-heading">
												<h2 class="panel-title">Create new folder</h2>
											</header>
											{% get_document_form as document_type_form %}
											{% get_department_form as department_form %}
											<form id="demo-form" action="{% url 'create_document_folder' %}" method="post" class="form-horizontal mb-lg" novalidate="novalidate">
													{% csrf_token %}
											<div class="panel-body">
												
													<div class="form-group mt-lg">
														<label class="col-sm-3 control-label">{{ document_type_form.folder_name.label_tag }}</label>
														<div class="col-sm-9">
															{{ document_type_form.folder_name }}
														</div>
													</div>

													<div class="form-group mt-lg">
														<label class="col-sm-3 control-label">{{ department_form.department.label_tag }}</label>
														<div class="col-sm-9">
															{{ department_form.department }}
														</div>
													</div>
													
													
													<div class="form-group">
														<label class="col-sm-3 control-label">{{ document_type_form.description.label_tag }}</label>
														<div class="col-sm-9">
															{{ document_type_form.description }}
														</div>
													</div>

													<div class="form-group">
														<label class="col-sm-3 control-label">{{ document_type_form.access_level.label_tag }}</label>
														<div class="col-sm-9">
															{{ document_type_form.access_level }}
															<span>{{ document_type_form.access_level.help_text }}</span>
														</div>
													</div>
												
											</div>
											<footer class="panel-footer">
												<div class="row">
													<div class="col-md-12 text-right">
														<button type="submit" class="btn btn-primary">Create</button>
														<button class="btn btn-default modal-dismiss">Cancel</button>
													</div>
												</div>
											</footer>
												</form>
										</section>
									</div>
									<!--end modal-->

									</div>
									{% endif %}
								</div>
								<div class="widget-content">
									<!--TODO: abetter tree view-->
									<!--
			 
										
									<div id="treeBasic">
										<ul>
											<li>
												 Home
												<ul>
												{% curate_my_directory request as folders %}

												{% if folders %}
												{% for folder in folders %}
													<li data-jstree='{ "selected" : true }'>
														<a href="#">Selected Node</a>
													</li>
													<li class="folder" >
														 <a href="{% url 'filter_repo_by_folder' folder.id %}">{{ folder.folder_name }}</a>
														
														<ul>
															{% for sub in folder.get_subfolders %}
															
															<li data-jstree='{ "disabled" : true }'>
																 Disabled Node
															</li>
															
															<li class="folder" data-jstree='{ "type" : "file" }'>
																 <a href="{% url 'filter_repo_by_folder' folder.id %}">{{ sub.folder_name }}</a>
															</li>
															{% endfor %}
														</ul>
													</li>
													
				 
													<li data-jstree='{ "icon" : "fa fa-picture-o" }'>
														 Custom Icon
													</li>
													<li data-jstree='{ "icon" : "assets/images/icon.png" }'>
														 Custom Icon Image
													</li>
														
													
												{% endfor %}
												{% endif %}
												</ul>
											</li>
											
										</ul>
									</div>
s
										
										-->

									<!-- Folder tree view start -->
									{% include 'staff/repository/folder_directory.html' %}
									<!--folder tree view end-->
								</div>
							</div>
							
							<hr class="separator" />
							<!-- TODO:get most popular tags -->
								<!--
									
							<div class="sidebar-widget m-none">
								<div class="widget-header">
									<h6 class="title">Labels</h6>
									<span class="widget-toggle">+</span>
								</div>
								<div class="widget-content">
									<ul class="mg-tags">
										
										{# {% get_resource_tags request  as tags%} #}
										<li><a href="#">Design</a></li>
										<li><a href="#">Projects</a></li>
										<li><a href="#">Photos</a></li>
										<li><a href="#">Websites</a></li>
										<li><a href="#">Documentation</a></li>
										<li><a href="#">Download</a></li>
										<li><a href="#">Images</a></li>
										<li><a href="#">Vacation</a></li>
									</ul>
								</div>
							</div>
						
								-->
						</div>
					</div>
				</div>
			</menu>
			<div class="inner-body mg-main">
							
				<div class="inner-toolbar clearfix">
					<ul>
						<!--
						<li>
							<a href="#" id="mgSelectAll"><i class="fa fa-check-square"></i> <span data-all-text="Select All" data-none-text="Select None">Select All</span></a>
						</li>
						<li>
							<a href="#"><i class="fa fa-pencil"></i> Edit</a>
						</li>
						<li>
							<a href="#"><i class="fa fa-trash-o"></i> Delete</a>
						</li>
						-->
						<li class="right" data-sort-source data-sort-id="media-gallery">
							<ul class="nav nav-pills nav-pills-primary">
								<li>
									<label>Filter:</label>
								</li>
								<li class="active">
									<a data-option-value="*" href="#all">All</a>
								</li>
								<li>
									<a data-option-value=".document" href="#document">Documents</a>
								</li>
								<li>
									<a data-option-value=".image" href="#image">Images</a>
								</li>
								<li>
									<a data-option-value=".video" href="#video">Videos</a>
								</li>
							</ul>
						</li>
					</ul>
				</div>
				<div class="row mg-files" data-sort-destination data-sort-id="media-gallery">
								
					<!--begin image lists-->

					{% for resource in resources %}
					{% for image in resource.get_images %}
					<div class="isotope-item image col-sm-6 col-md-4 col-lg-5">
						<div class="thumbnail">
							<div class="thumb-preview">
								<a class="thumb-image" href="{{ image.image.url }}">
									<img src="{{ image.image.url }}" class="img-responsive" alt="Project">
								</a>
								<div class="mg-thumb-options">
									<div class="mg-zoom"><i class="fa fa-search"></i></div>
									<div class="mg-toolbar">
										
										
									</div>
								</div>
							</div>
							<h5 class="mg-title text-semibold">{{ image.name_of_image }}<small>{{ image.get_extension }}</small></h5>
							
							<div class="mg-description">
								
								<ul class="mg-menu" style="list-style:none;" role="menu">
									<li><a class="btn-sm btn-primary" href="{{ image.image.url }}" download><i class="fa fa-download"></i> Download</a></li><br />
									<li><a class="btn-sm btn-primary" href="{% url 'view_image' image.id %}" ><i class="fa fa-file-o"></i> More</a></li>
								</ul>
								<small class="pull-left text-muted">Images, Photos</small><br />
								
								{% if request.user.is_authenticated %}
								<small class="pull-left text-muted">Uploaded by:</small><a href="{% url 'get_user_dashboard' resource.created_by.id 'images' %}">{{ resource.created_by.first_name }}</a><br>
								<small class="pull-right text-muted">Last modified: -{{ image.updated_at }}</small>
								{% endif %}
								<span>[ {{ image.repository.access_level }} ]</span>
							</div>
						</div>
					</div>
					{% endfor %}
					{% endfor %}
					<!--end image list-->

					<!--begin document lists-->
					{% for resource in resources %}
					{% for document in resource.get_documents %}
					<div class="isotope-item document col-md-12 col-md-6 col-lg-3">
						<div class="thumbnail">
							<div class="thumb-preview">
								<a class="thumb-image" href="{{ document.reference_material_download.url }}">
									<img src="{% static 'assets/img/file.png' %}" class="img-responsive" alt="Project">
								</a>
								<div class="mg-thumb-options">
								<!--
									<div class="mg-zoom"><i class="fa fa-search"></i></div>
								-->			
								</div>
							</div>
							<h5 class="mg-title text-semibold">{{ document.name_of_document }}<small>{{ document.get_extension }}</small></h5>
							<div class="mg-description">
								
								<a class="btn-sm btn-primary" href="{{ document.reference_material_download.url }}" download><i class="fa fa-download"></i> Download</a><br /><hr />
								<a class="btn-sm btn-primary" href="{% url 'view_document' document.id %}" ><i class="fa fa-file-o"></i> More</a>
								<small class="pull-left text-muted">Documents, Files</small><br />
								
								{% if request.user.is_authenticated %}
								<small class="pull-left text-muted">Uploaded by:</small><a href="{% url 'get_user_dashboard' resource.created_by.id 'documents' %}">{{ resource.created_by.first_name }}</a><br>
								<small class="pull-right text-muted">Last updated: {{ document.updated_at }}</small>
								{% endif %}
								<span>[ {{ document.repository.access_level }} ]</span>
							</div>
						</div>
					</div>
					{% endfor %}
					{% endfor %}
					<!--end document list-->

					<!--begin video lists-->
					{% for resource in resources %}
					{% for video in resource.get_videos %}
					<div class="isotope-item video col-md-3 col-md-3 col-lg-5">
						<div class="thumbnail">
							<div class="thumb-preview">
								<a class="thumb-image" href="{{ video.video_file.url }}">
									<img src="{% static 'assets/img/video.png' %}" class="img-responsive" alt="Project">
								</a>
								<!-- <div class="mg-thumb-options">
									<div class="mg-zoom"><i class="fa fa-search"></i></div>
													
								</div> -->
							</div>

							<h5 class="mg-title text-semibold">{{ video.name_of_video }}<small>{{ video.get_extension }}</small></h5>
							<div class="mg-description">
								
								<ul style="list-style:none;">
									<li><a class="btn-sm btn-primary" href="{% url 'play_repo_video' video.id %}"><i class="fa fa-play"></i> Play</a></li><br />
									<li><a class="btn-sm btn-primary" href="{{ video.video_file.url }}" download><i class="fa fa-download"></i> Download</a></li><hr />
								</ul>
								<small class="pull-left text-muted">Video</small><br />
								{% if request.user.is_authenticated %}
								<small class="pull-left text-muted">Uploaded by:</small><a href="{% url 'get_user_dashboard' resource.created_by.id 'videos' %}">{{ resource.created_by.first_name }}</a><br>
								<small class="pull-right text-muted">Last updated: {{ video.updated_at }}</small>
								<span>[ {{ video.repository.access_level }} ]</span>
								{% endif %}
							</div>
						</div>
					</div>
					{% endfor %}
					{% endfor %}
					<!--end document list-->
									
				</div>
				{% if resource is None and resources is None %}
					<div>
						<p>images not found. Try searching.</p>
					</div>
				{% endif %}
			</div>
		</div>
	</section>
	<!-- end: page -->

{% endblock %}