{% extends 'staff/repository_layout.html' %}
{% load staticfiles %}
<<<<<<< HEAD
=======
{% load form_tags %}
>>>>>>> deployment-backup
{% block styles %}
		
	<link rel="stylesheet" href="{% static 'repository_assets/vendor/select2/select2.css' %}" />
	<link rel="stylesheet" href="{% static 'repository_assets/vendor/jquery-datatables-bs3/assets/css/datatables.css' %}" />
{% endblock %}

{% block content %}
    <div class="clearfix"></div>
<!-- start: page -->

	<div class="row">
		<div class="col-md-4 col-lg-3">

			<section class="panel">
				<div class="panel-body">
					<div class="thumb-info mb-md">
						<img src="assets/images/!logged-user.jpg" class="rounded img-responsive" alt="John Doe">
						<div class="thumb-info-title">
							<span class="thumb-info-inner">{{ user.first_name }} {{ user.last_name }}</span>
							<span class="thumb-info-type">{{ user.profile.role }}</span>
						</div>
					</div>

<<<<<<< HEAD
=======
					{% if request.user == user %}
>>>>>>> deployment-backup
					<div class="widget-toggle-expand mb-md">
						<div class="widget-header">
							<h6><strong>Profile Completion</strong></h6>
							<div class="widget-toggle">+</div>
						</div>
						<div class="widget-content-collapsed">
							<!--
							<div class="progress progress-xs light">
								<div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
									60%
								</div>
							</div>
							-->
						</div>
						<div class="widget-content-expanded">
							<ul class="simple-todo-list">
<<<<<<< HEAD
								<li {% if user.profile.email_confirmed %}class="completed"{% endif %}>Confirm email</li>
								<li {% if user.profile.role %} class="completed" {% endif %}>Change Personal Information</li>
=======
								<li {% if user.is_active %}class="completed"{% endif %}>Confirm email</li>
								<li {% if user.profile.role %} class="completed" {% endif %}>Update Personal Information</li>
>>>>>>> deployment-backup
								<li {% if user.get_overview.count > 0 %}class="completed"{% endif %}>Upload something</li>
								<!-- <li>Follow Someone</li> -->
							</ul>
						</div>
					</div>
<<<<<<< HEAD

					<hr class="dotted short">

					<h6 class="text-muted">About</h6>
					<p>{{ user.profile.bio }}</p>
=======
					{% endif %}
					<hr class="dotted short">

					{% if user.profile.bio.is_public or request.user == user %}
					<h6 class="text-muted">About</h6>
					<p>{{ user.profile.bio }}</p>
					
>>>>>>> deployment-backup
					<div class="clearfix">
					</div>

					<hr class="dotted short">

					<div class="col-md-12">
						<a rel="tooltip" data-placement="bottom" target="_blank" href="mailto:{{ user.email.url }}" data-original-title="Send Mail"><i class="fa fa-envelope-square"></i><span>Send mail</span></a>

					</div>
<<<<<<< HEAD
=======
					{% endif %}
>>>>>>> deployment-backup

				</div>
			</section>


		</div>
<<<<<<< HEAD
		<h4 class="mb-md">User Dashboard</h4>
=======
		<h4 class="mb-md">Staff Dashboard</h4>
>>>>>>> deployment-backup
		<div class="col-md-8 col-lg-9">

			<div class="tabs">
				<ul class="nav nav-tabs tabs-primary">
					<li {% if tab == 'overview' %} class="active" {% endif %}>
						<a href="{% url 'get_user_dashboard' user.id 'overview' %}" >Overview</a>
					</li>
					<li {% if tab == 'documents' %} class="active" {% endif %}>
						<a href="{% url 'get_user_dashboard' user.id 'documents' %}" >Documents</a>
					</li>
					<li {% if tab == 'images' %} class="active" {% endif %}>
						<a href="{% url 'get_user_dashboard' user.id 'images' %}" >Images</a>
					</li>
					<li {% if tab == 'videos' %} class="active" {% endif %}>
						<a href="{% url 'get_user_dashboard' user.id 'videos' %}" >Videos</a>
					</li>
					{% if request.user == user %}
					<li {% if tab == 'edit' %} class="active" {% endif %}>
						<a href="{% url 'get_user_dashboard' request.user.id 'edit' %}" >Edit</a>
					</li>
					{% endif %}
					
				</ul>
				<div class="tab-content">
					<div id="overview" class="tab-pane {% if tab == 'overview' %} active {% endif %}">
						<h4 class="mb-md">Overview</h4>

						<ul class="simple-card-list mb-xlg">
							<li class="info">
								<a href="{% url 'get_user_dashboard' user.id 'documents' %}" >
									<h3>{{ user.get_my_documents|length }}</h3>
									<p>Documents</p>
								</a>
							</li>
							<li class="info">
								<a href="{% url 'get_user_dashboard' user.id 'images' %}" >
									<h3>{{ user.get_my_images|length }}</h3>
									<p>Photos</p>
								</a>
							</li>
							<li class="info">
								<a href="{% url 'get_user_dashboard' user.id 'videos' %}" >
									<h3>{{ user.get_my_videos|length }}</h3>
									<p>Videos</p>
								</a>
							</li>
						</ul>

						<div class="row">
							
												<br />
						
												
						</div>
						
					</div>

					<div id="documents" class="tab-pane {% if tab == 'documents' %} active {% endif %}">

<!-- start: documents table -->
							<section class="panel">
								<header class="panel-heading">
									<div class="panel-actions">
										
									</div>
						
									<h2 class="panel-title">Documents</h2>
								</header>
								<div class="panel-body">
									<div class="row">
										<div class="col-sm-6">
											<!--
											<div class="mb-md">
												<button id="addToTable" class="btn btn-primary">Add <i class="fa fa-plus"></i></button>
											</div>
											-->
										</div>
									</div>
									{% if tab == 'documents' %}
									<table class="table table-bordered table-striped mb-none" id="datatable-editable">
										<thead>
											<tr>
												<th>Name</th>
												<th>Description</th>
<<<<<<< HEAD
												<th>Type</th>
=======
												<th>Folder</th>
>>>>>>> deployment-backup
												<th>Actions</th>
											</tr>
										</thead>
										<tbody>
											
											{% for document in user.get_my_documents %}
											<tr class="gradeX">
												<td>
<<<<<<< HEAD
													
													{{ document.name_of_document }}
												</td>
												<td>{{ document.repository.description | safe }}</td>
												<td>{{ document.repository.doc_type.document_type }}</td>
=======
													<a class="link" href="{% url 'view_document' document.id %}" > {{ document.name_of_document }}</a>
													 <span class="text-info">[{{ document.repository.publish_status }}]</span>
												</td>
												<td>{{ document.repository.description | safe }}</td>
												<td>{{ document.repository.department_folder }} | <span class="text-info">[ {{ document.repository.department_folder.access_level }} ]</span></td>
												
>>>>>>> deployment-backup
												
												<td class="actions">
													<a href="#" class="hidden on-editing save-row"><i class="fa fa-save"></i></a>
													<a href="#" class="hidden on-editing cancel-row"><i class="fa fa-times"></i></a>
													<a href="{{ document.reference_material_download.url }}" download class="on-default download-row"><i class="fa fa-download"></i></a>
													{% if request.user == user %}
													<a href="{% url 'get_update_repo_resource' document.repository.id %}" class="on-default"><i class="fa fa-pencil"></i></a>
													<a href="{% url 'delete_repo_document' document.id %}"onclick="return confirm('Are you sure you want to delete this item?');" class="on-default"><i class="fa fa-trash-o" style="color:red;"></i></a>
													{% endif %}
												</td>
											</tr>
											{% endfor %}
											
										</tbody>
									</table>
									{% endif %}
								</div>
							</section>
						<!-- end: document table -->
					</div>
					
					<div id="images" class="tab-pane {% if tab == 'images' %} active {% endif %}">

						<!-- start: images table -->
							<section class="panel">
								<header class="panel-heading">
									
									<h2 class="panel-title">Photos</h2>
								</header>
								<div class="panel-body">
									<div class="row">
										<div class="col-sm-6">
											<!--
											<div class="mb-md">
												<button id="addToTable" class="btn btn-primary">Add <i class="fa fa-plus"></i></button>
											</div>
											-->
										</div>
									</div>
									{% if tab == 'images' %}
									<table class="table table-bordered table-striped mb-none" id="datatable-editable">
										<thead>
											<tr>
												<th>Photo</th>
												<th>Description</th>
<<<<<<< HEAD
												<th>Type</th>
=======
												<th>Folder</th>
>>>>>>> deployment-backup
												<th>Actions</th>
											</tr>
										</thead>
										<tbody>
											
											{% for image in user.get_my_images %}
											<tr class="gradeX">
												<td>
													<div class="thumb-preview">
														<a class="thumb-image" href="{{ image.image.url }}">
															<img src="{{ image.image.url }}" class="img-responsive" alt="Project">
														</a>
												
													</div>
<<<<<<< HEAD
												</td>
												<td>{{ image.repository.description | safe }}</td>
												<td>{{ image.repository.doc_type.document_type }}</td>
=======
													<h5>{{ image.name_of_image }}</h5>
													<span class="text-info">[ {{ image.repository.access_level }} | {{ image.repository.publish_status }} ]</span>
												</td>
												<td>{{ image.repository.description | safe }}</td>
												<td>{{ image.repository.department_folder }}</td>
>>>>>>> deployment-backup
												<td class="actions">
													<a href="#" class="hidden on-editing save-row"><i class="fa fa-save"></i></a>
													<a href="#" class="hidden on-editing cancel-row"><i class="fa fa-times"></i></a>
													<a href="{{ image.image.url }}" download class="on-default download-row"><i class="fa fa-download"></i></a>
													{% if request.user == user %}
													<a href="{% url 'get_update_repo_resource' image.repository.id %}" class="on-default"><i class="fa fa-pencil"></i></a>
													<a href="{% url 'delete_repo_image' image.id %}" onclick="return confirm('Are you sure you want to delete this item?');" class="on-default"><i class="fa fa-trash-o" style="color:red;"></i></a>
													{% endif %}
												</td>
											</tr>
											{% endfor %}
											
										</tbody>
									</table>
									{% endif %}
								</div>
							</section>
						<!-- end: images	 table -->
					
					</div>

					<div id="videos" class="tab-pane {% if tab == 'videos' %} active {% endif %}">

						<!-- start: images table -->
							<section class="panel">
								<header class="panel-heading">
									<div class="panel-actions">
										
									</div>
						
									<h2 class="panel-title">Videos</h2>
								</header>
								<div class="panel-body">
									<div class="row">
										<div class="col-sm-6">
											<!--
											<div class="mb-md">
												<button id="addToTable" class="btn btn-primary">Add <i class="fa fa-plus"></i></button>
											</div>
											-->
										</div>
									</div>
									{% if tab == 'videos' %}
									<table class="table table-bordered table-striped mb-none" id="datatable-editable">
										<thead>
											<tr>
												<th>Video</th>
												<th>Description</th>
<<<<<<< HEAD
												<th>Type</th>
=======
												<th>Folder</th>
>>>>>>> deployment-backup
												<th>Actions</th>
											</tr>
										</thead>
										<tbody>
											
											{% for video in user.get_my_videos %}
											<tr class="gradeX">
												<td>
													<div class="embed-responsive embed-responsive-4by3">
														<video width='320' height= '240' controls>
														<source src="{{ video.video_file.url }}">
														Your browser does not support the video tag.
														</video>
													</div>
<<<<<<< HEAD
												</td>
												<td>{{ video.repository.description | safe }}</td>
												<td>{{ video.repository.doc_type.document_type }}</td>
=======
													<h5>{{ video.name_of_video }}</h5>
													<span class="text-info">[ {{ video.repository.access_level }} | {{ video.repository.publish_status }} ]</span>
												</td>
												<td>{{ video.repository.description | safe }}</td>
												<td>{{ video.repository.department_folder }}</td>
>>>>>>> deployment-backup
												
												<td class="actions">
													<a href="#" class="hidden on-editing save-row"><i class="fa fa-save"></i></a>
													<a href="#" class="hidden on-editing cancel-row"><i class="fa fa-times"></i></a>
													<a href="{{ video.video_file.url }}" download class="on-default download-row"><i class="fa fa-download"></i></a>
													{% if request.user == user %}
													<a href="{% url 'get_update_repo_resource' video.repository.id %}" class="on-default"><i class="fa fa-pencil"></i></a>
													<a href="{% url 'delete_repo_video' video.id %}" onclick="return confirm('Are you sure you want to delete this item?');" class="on-default"><i class="fa fa-trash-o" style="color:red;"></i></a>
													{% endif %}
												</td>
											</tr>
											{% endfor %}
											
										</tbody>
									</table>
									{% endif %}
								</div>
							</section>
						<!-- end: images	 table -->
					
					</div>

					<div id="edit" class="tab-pane {% if tab == 'edit' %} active {% endif %}">
						{% if request.user == user %}
						{% load form_tags %}
						{% get_profile_form request.user as profile_form %}
						<form class="form-horizontal" method="post" action="{% url 'update_user_profile' %}">
 							<h4 class="mb-xlg">Personal Information</h4>
							{% csrf_token %}
							<fieldset>
								<div class="form-group">
									<label class="col-md-3 control-label" for="profileFirstName">First Name</label>
									<div class="col-md-8">
										<input type="text" name="first_name" value="{{user.first_name}}" class="form-control" id="profileFirstName">
									</div>
								</div>
								<div class="form-group">
									<label class="col-md-3 control-label" for="profileLastName">Last Name</label>
									<div class="col-md-8">
										<input type="text" name="last_name" value="{{user.last_name}}" class="form-control" id="profileLastName">
									</div>
								</div>
<<<<<<< HEAD
=======
								{% if request.user.is_superuser %}
>>>>>>> deployment-backup
								<div class="form-group">
									<label class="col-md-3 control-label" for="profileAddress">Department</label>
									<div class="col-md-8">
										{{ profile_form.department }}
									</div>
								</div>
<<<<<<< HEAD
=======
								{% endif %}
>>>>>>> deployment-backup
								<div class="form-group">
									<label class="col-md-3 control-label" for="profileCompany">Role</label>
									<div class="col-md-8">
										<input type="text" name="role" value="{{user.profile.role}}" class="form-control" id="profileCompany">
									</div>
								</div>
							</fieldset>
							<hr class="dotted tall">
							<h4 class="mb-xlg">About Yourself</h4>
							<fieldset>
								<div class="form-group">
									<label class="col-md-3 control-label" for="profileBio">Biographical Info</label>
									<div class="col-md-8">
										<textarea class="form-control" name="bio" rows="3" id="profileBio">{{user.profile.bio}}</textarea>
									</div>
								</div>
								<div class="form-group">
									<label class="col-xs-3 control-label mt-xs pt-none">Public</label>
									<div class="col-md-8">
										<div class="checkbox-custom checkbox-default checkbox-inline mt-xs">
											
											<input type="checkbox" name="bio_ispublic"  {% if user.profile.bio_ispublic == True %} checked {% endif %} id="profilePublic">
											<label for="profilePublic"></label>
										</div>
									</div>
								</div>
							</fieldset>
							<hr class="dotted tall">
							<!--
		   
<<<<<<< HEAD
								<h4 class="mb-xlg">Change Password</h4>
=======
								
>>>>>>> deployment-backup
							<fieldset class="mb-xl">
								<div class="form-group">
									<label class="col-md-3 control-label" for="profileNewPassword">New Password</label>
									<div class="col-md-8">
										<input type="text" class="form-control" id="profileNewPassword">
									</div>
								</div>
								<div class="form-group">
									<label class="col-md-3 control-label" for="profileNewPasswordRepeat">Repeat New Password</label>
									<div class="col-md-8">
										<input type="text" class="form-control" id="profileNewPasswordRepeat">
									</div>
								</div>
							</fieldset>
								-->
							<input type="hidden" value="{{ user.id }}" name="user_id" />
							<input type="hidden" value="{{ tab }}" name="tab" />
							<div class="panel-footer">
								<div class="row">
									<div class="col-md-9 col-md-offset-3">
										<button type="submit" class="btn btn-primary">Submit</button>
										<button type="reset" class="btn btn-default">Reset</button>
									</div>
								</div>
							</div>

						</form>
<<<<<<< HEAD
=======

						<h4 class="mb-xlg"><u>Change Password</u></h4>
                          <form method="post" action="{% url 'change_password' %}">
                              {% csrf_token %}
                          {% get_password_change_form request.user as pass_form %}
                              <fieldset>
								  {{ pass_form }}
							  </fieldset>

                              {% for error in pass_form.errors %}
                              <p class="text-danger">{{ error }}</p>
                              {% endfor %}<br />
                              <button type="submit" class="btn-sm btn-primary">Save changes</button>
                            </form>
>>>>>>> deployment-backup
						{% endif %}
					</div>

				</div>
			</div>
		</div>
							

	</div>
	
	<!-- end: page -->
{% endblock %}

{% block javascript %}
		
		<!-- Specific Page Vendor -->
		<script src="{% static 'repository_assets/vendor/select2/select2.js' %}"></script>
		<script src="{% static 'repository_assets/vendor/jquery-datatables/media/js/jquery.dataTables.js' %}"></script>
		<script src="{% static 'repository_assets/vendor/jquery-datatables-bs3/assets/js/datatables.js' %}"></script>
		<script src="{% static 'repository_assets/javascripts/tables/examples.datatables.editable.js' %}"></script>
{% endblock %}